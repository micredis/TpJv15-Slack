Grigory Kislin [11:30 PM]
joined #hw5.

Grigory Kislin [11:32 PM]
Добро пожаловать на 5е занятие: https://github.com/JavaWebinar/topjava/blob/doc/doc/lesson05.md
Первое видео с миграцией на jdk11 буду дорабатывать и, как выложу, напишу отдельно (edited)

severek [11:34 PM]
joined #hw5 along with 18 others.

Taras [10:02 AM]
Ого, jdk 11! Нам тоже надо будет поставить и перейти?

Grigory Kislin [10:03 AM]
Да, нужно. Решил перейти- будем идти в ногу со временем.

Grigory Kislin [10:26 AM]
Добавил *5_9_jdk11_fix.patch*
Поправил версию JDK в `.travis.yml` (edited)

Vitaliy Ivkin [11:47 AM]
Последний раз, когда перекатывался с разных JDK было много танцев с бубном и слетевших настроек :sweat_smile:
Ну, поехали

Grigory Kislin [12:16 PM]
да, IDEA не надо пробовать запускать из JDK 11. она сама ругается и просится обратно под свой JRE
если деплоится в tomcat не через idea- нужно поменять JAVA_HOME


ABaykov [Yesterday at 12:24 PM]
вопрос - что всё таки ставить OpenJDK или OracleJDK ? или для не коммерческого использования разницы не будет?


1 reply
Taras [20 hours ago]
У нас без разницы. У меня стоит oracle.


Roman Baranov [Yesterday at 12:25 PM]
при накатке патча `5_5_profiles_connection_pool.patch`
возникают конфликты в файлах src/main/resources/db/hsqldb.properties, pom.xml


1 reply
Roman Baranov [1 day ago]
починил через апдейт из оригинального  topjava repo


Maxim Valeev [Yesterday at 12:28 PM]
после патча 5_6_profile_resolver ловлю экспепшн в тестах. Профиль подключен Postgres, почему URL подтягивается из hsqldb.properies?
Снимок.PNG



3 replies
Maxim Valeev [1 day ago]
т.е. у меня все тянется из hsqldb.properties, хотя стоит профиль postgres


Maxim Valeev [1 day ago]
Починил)


Tony [1 day ago]
https://pbs.twimg.com/media/Dpj067-W0AE2I_m.jpg (187 kB)


Maxim Valeev [12:28 PM]
1.PNG 


fonto [Yesterday at 12:53 PM]
Мне одному кажется, что var заместо Map<>, менее удобно?


12 replies
fonto [1 day ago]
Или в этом кроется какой-то смысл о котором я не знаю?


Ansseii [1 day ago]
В уроке была статья с рассуждениями на эту тему) Как по мне - тут вопрос чисто эстетический. Я, вероятно, буду пользовать var в  ситуации, где требуется создать объект, а там будет не Map или, скажем, Integer, а название символов в 50+, что для спринга похоже есть норма)


ABaykov [1 day ago]
+1, если будет переменная из разряда AutowiredAnnotationBeanPostProcessor, то проще его на var заменить)


Gekov Iliya [1 day ago]
Да по сути для использования в циклах и методах для переменных, которые объявил, поиспользовал да забыл)

Zhinko [24 hours ago]
Это с непривычки кажется неудобным.

KaryNaiKo [22 hours ago]
А как это читать?
Вот вижу я впервые метод delet
   @Override
   public boolean delete(int id, int userId) {
       var meals = repository.get(userId);
       return meals != null && meals.remove(id) != null;

   }
что я удаляю?!
Сильно страдает понимание кода.
Нихатюююююю(((( (edited)


KaryNaiKo [22 hours ago]
Ладно еще в идее, где могу глянуть с помощью alt. Но а если я смотрю код без IDE? Короче, здесь считаю нельзя применять var (edited)


Zhinko [19 hours ago]
Ну тут просто вместо типа List используется var. В принципе понятно. А в javascript например там везде var

Gekov Iliya [19 hours ago]
Это понятно тому, кто этот метод писал, а тому, кто просто его читает, придется лезть смотреть, что этот метод возвращает. Мне кажется, var удобен лишь там, где мы сразу видим тип переменной по правой части после =.


Zhinko [19 hours ago]
Ну да, и тут ещё нужно чтобы название переменных отражало суть. По логике если meals то это скорее всего список


Gekov Iliya [19 hours ago]
Или мапа или сет или вообще массив)


Gekov Iliya [19 hours ago]
Вобщем злоупотреблять не стоит наверное...)


Dima [Yesterday at 5:39 PM]
мда, придется видимо новую идею поставить, после первого же патча все красное, ругается на List.of(). SDK 11 поставил, а вот уровнем языка стоит 9 и не выше. Как думаете спасет новая идея?  меня сейчас 2017.3.4


9 replies
Gekov Iliya [1 day ago]
Думаю да, 2018.2.2 никаких проблем


Dima [1 day ago]
качаю уже, месяц так поюзаю,потом использую купон


Dima [23 hours ago]
ну все, проблема ушла) токо я как нищеброд на триале))


Стецко Максим [23 hours ago]
лицензия же к аккаунту привязана, авторизуйся


Dima [23 hours ago]
как я понимаю,если я авторизируюсь 1 декабря, то срок лицензии пойдет с 1 декабря. а если сейчас- то сейчас. Или я не прав?


Стецко Максим [23 hours ago]
да вроде прав, а сейчас у тебя был еще триал чтоли?


Dima [23 hours ago]
сейчас у меня был perpetul , типо вечная необновляемая версия


Sergey Zhukov [19 hours ago]
блин нижний бар теперь весь серый, и вообще с каждым переходом цвета пропадают :confused:


Dima [19 hours ago]
все ближе к темной стороне...


Gekov Iliya [Yesterday at 7:43 PM]
В материалах к занятию есть 5_5_profiles_connection_pool.patch и 5_5_profiles_connection_pool1.patch, когда пробую применить первый - идея ругается на несколько мест в коде, что не может применить изменения, когда применяю второй (не пытаясь применить первый) - все ок. Это только у меня или кто-то еще столкнулся с этим?


3 replies
Gekov Iliya [22 hours ago]
У всех все ок с этим патчем?


Gekov Iliya [21 hours ago]
Вроде разобрался, если накатывать только 5_5_profiles_connection_pool1.patch, то все вроде ок, сверился с основным репозиторием


Zhinko [19 hours ago]
Да второй накатывайте и все норм будет


KaryNaiKo [Yesterday at 9:37 PM]
После перехода на 11 java мавен стал выдавать
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by com.thoughtworks.xstream.core.util.Fields (file:/C:/Users/Павлуша/.m2/repository/com/thoughtworks/xstream/xstream/1.3.1/xstream-1.3.1.jar) to field java.util.Properties.defaults
WARNING: Please consider reporting this to the maintainers of com.thoughtworks.xstream.core.util.Fields
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
Что это значит?

Плюс не запускается проект
Root Cause

org.hibernate.HibernateException: Access to DialectResolutionInfo cannot be null when 'hibernate.dialect' not set
    org.hibernate.engine.jdbc.dialect.internal.DialectFactoryImpl.determineDialect(DialectFactoryImpl.java:100)
    org.hibernate.engine.jdbc.dialect.internal.DialectFactoryImpl.buildDialect(DialectFactoryImpl.java:54)
    org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:137)
    org.hibernate.engine.jdbc.env.internal.JdbcEnvironmentInitiator.initiateService(JdbcEnvironmentInitiator.java:35) (edited)


10 replies
Sergey Zhukov [20 hours ago]
clean делал?


KaryNaiKo [20 hours ago]
делал


Alexey_b [20 hours ago]
что-то опасаюсь на рабочем ноуте 11 ставить, это надо по идее 2 джавы и с помощью path регулировать какая сейчас активная?


Zhinko [19 hours ago]
Там же в настройках проекта можно выбрать версию джавы.


Zhinko [19 hours ago]
Я скачал и поменял на 11. У меня все норм работает


Sergey Zhukov [19 hours ago]
я поставил рядом с 2017.3.3
активировал купон
все так же запускается
версия языка 11, jdk-11.0.1, накатил 5_0_jdk_11.patch


Sergey Zhukov [19 hours ago]
ругается на maven, удали его репозиторий, пусть заново создаст
C:/Users/Павлуша/.m2


KaryNaiKo [19 hours ago]
Решил проблему с hibernate. У меня каким-то образом умерла БД, пришлось удалять и делать новую.
А вот предупреждения так и появляются. Все работает. С этим можно жить? :smile:
Умерла так
FATAL: catalog is missing 17 attribute(s) for relid 2600 (edited)


Gekov Iliya [19 hours ago]
Время покажет) "Работает - не трогай" (с)  :grin:

Taras [10 hours ago]
@KaryNaiKo Ты бы кириллицу исключил из путей. Это верный способ нажить себе неожиданных проблем.


This message was deleted.


22 replies
Ilya A. Kvyatkovsky [17 hours ago]
Сори, расчувствовался! Пойду спать, завтра буду разгребать эту свалку.:mountain: (edited)


shomnest [12 hours ago]
@Ilya A. Kvyatkovsky добро пожаловать в мир кровавого энтерпрайза, это над тобой ещё ПМ не стоит и не требует что бы все было готово ещё вчера.


Dima [11 hours ago]
Ты видимо не с javaRush тут? Потому что после борьбы с валидатором заданий этот проект кажется просто чуть сложнее. Да,много всего и надо много гуглить,но как я понимаю,это и есть будущая работа)



vch [11 hours ago]
Тут пока лайт-версия ПМ в виде Татьяны, требующей сдать HW к вечеру вторника :slightly_smiling_face:


Gekov Iliya [10 hours ago]
Думаю в реальной работе, особенно если вливаться в готовый проект, все будет в разы хуже в этом плане, надо как то привыкать и приспосабливаться. Возможно, стоит побольше времени уделить чтению теории, какой-нибудь из популярных книг по спрингу, хибернейту, jpa. Пока готовился к стажировке почитал Pro Spring к примеру и как то пока особых сложностей в усвоении материала нет. Так же не стоит забывать, что этот проект называется именно стажировкой, а не лекции с семинарами, то есть максимальное приближение к реальной работе. Мне наоборот нравится, что перед нами ставят именно такие задачи - вот тебе проект, вот тебе такая то технология, изучи ее, внедри, а потом почини что поломалось)


Gekov Iliya [9 hours ago]
И обязательно посмотрите Борисова по spring data (ссылка в материалах)



Ilya A. Kvyatkovsky [8 hours ago]
Теперь ясно понимаю, почему многие заходят по 2 и 3 кругу на стажировку. Освоить с первого раза такой объем крайне сложно.
В статьях и видео много говорят что нужно писать простой и понятный код, а на практике получается все наоборот. Если, как вы говорите на продакшене все проекты в виде фарша из технологий, то в индустрии явно нехватка грамотных архитекторов.
И это наверное будет точкой роста для меня. (Если, конечно, хватит упорства освоить все это).
Пост убрал потому, что это скорее флудинг и нытье.
П.С.: JavaRush - это детский лепет по сравнению с тем что мы имеем здесь.


Gekov Iliya [8 hours ago]
Уж не знаю куда еще проще код, чем в spring data, унаследовался от интерфейса и всё - crud репозиторий готов. Если spring boot использовать, то еще в разы код упрощается.


Gekov Iliya [8 hours ago]
Да и о каком фарше идет речь? Нужна проекту технология - добавили, не нужна - убрали, естественно это все переплетается кучей зависимостей, но никакого фарша не вижу, все легко через мавен контролируется. У нас проект учебный, попробовали реализацию с jdbc, попробовали jpa, теперь пробуем spring data, видим в чем отличие, почему это удобнее и т.п. В реальном проекте естественно мы бы сразу взяли, к примеру, спринг дата и всё


Gekov Iliya [8 hours ago]
Да и не был бы у джавы ЕЕ такой высокий порог вхождения, не было бы и соответствующих з/п) никто не обещал что будет легко)


Ilya A. Kvyatkovsky [7 hours ago]
@Gekov Iliya Илья, все верно, мы рассмотрели сначала одну технологию, потом вторую, затем третью. Но если бы мы рассматривали их каждую на чистом проекте (те полностью очищали от предыдущего варианта) тогда бы было наглядно видно что нам нужно для одного а что для другого. А сейчас у нас получается, что все накладывается друг на друга.


Gekov Iliya [7 hours ago]
Не соглашусь. В реальном рабочем проекте при переходе от одной технологии к другой тоже будете проект очищать? Мы учимся работать с реальным проектом, а не создавать абстрактные примеры использования отдельных технологий - этого итак в инете куча (edited)


Dima [7 hours ago]
Мы пользуемся благами спринга и внедрением зависимомтей,как раз сейчас видно все плюсы,в коде можетбыть куча всего,но по конфигкрационному файлу ясно,что сейчас у нас попадает в контекст,а что нет.



Gekov Iliya [7 hours ago]
Кстати да, если бы мы все подчищали, то какой вообще прок от IoC контейнера?


Ilya A. Kvyatkovsky [7 hours ago]
@Gekov Iliya @Dima Как давно Вы вошли в Java? Вероятно мой бэкграунд маловат или мозг!? Я с Java начал свое знакомство этим летом на явераш, за три месяца добрался до 35 уровня и на стажировку. Наверное я слишком быстро кинулся на стажировку а сейчас тупо не хватает опыта. Хотя в принципе то что дает Григорий достаточно для освоения проекта. Как давно Вы занимаетесь джавой?


Gekov Iliya [7 hours ago]
Около года, начал с джавараша, на середине понял что не хватает теории, ушел читать книги, которые считаются мастрид для джавы, посмотрел почти всего Головача на ютубе. Паралельно прошел дипломный курс по проф. переквалификации в Специалисте при Бауманке. Вернулся на джавараш, дорешал, в ожидании стажировки читал, пробовал спринг, вобщем то и всё.. до этого опыта в програм. 0 (edited)


Dima [7 hours ago]
Я начал в 2015 на javarush,дошел до 20 уровня,потом забросил изза работы. Этой весной решил ,что мояработа меня зае...))) решил продолжить,но начал сначала. Когда писал задание на стажировку впервые услышал про спринг, jdbc и т.д Прочел пару книг,и просиотрел дофига часов на ютубе.

Dima [7 hours ago]
И на udemy прошел курс спринг и хибернэйт,довольно неплохой.Всем советую книгу Spring 5 in action (edited)


Ilya A. Kvyatkovsky [6 hours ago]
Ясно, бэк у меня дохленький, потому и взрыв мозга иногда случается. Есть к чему стремиться. Спасибо что поделились. Продолжу разбираться с проектом и make home work. Что нас не убивает, то делает нас сильнее. Через терни к звездам. По**дел...


shomnest [6 hours ago]
@Ilya A. Kvyatkovsky эт ты еще ejb не видел и надеюсь не увидишь, потому как оно нафиг ни кому не надо видеть)) или полотен js файлов или бэк на node, где вообще параллельная вселенная системы типов. Ну, а если серьезно, то не так страшен черт, главное правило это "разделяй и властвуй", мысленно (ну или на бумажке) разделяй все на подкомпоненты, проводи декомпозицию задач и вся связность будет как на ладони, то для чего и куда. Ну, еще наверное стоит книженцию какую-нибудь по паттернам пролистать или Роберта Мартина чего - нибудь.


Ilya A. Kvyatkovsky [6 hours ago]
@shomnest Вот-вот, про разделяй и властвуй это ты верно излагаешь, только вот c делением у меня пока трудности.


shomnest [6 hours ago]
научишься


fonto [Today at 1:52 AM]
Профили это о супер удобная штука для тестирования и одно из самых крутых нововведений о которых я узнал в этом проекте. Спасибо!


2 replies
Gekov Iliya [10 hours ago]
Согласен, красиво выглядит, главное самому в них не запутаться)


fonto [2 hours ago]
Если разобраться, то уже не запутаешься)), удобно очень)


Artem [Today at 6:19 AM]
Кто в курсе как теперь будет происходить компиляция проекта на jdk 11, если jre убрали? Как допустим исполняемый файл передавать на другой комп и что на него устанавливать чтобы фишки 11 java были доступны? И если оставить jre 8 будет ли работать программа? Где про это почитать можно


6 replies
Sergey Zhukov [11 hours ago]
jre - часть jdk, необходимая только для запуска... так что ставь jdk и сможешь запускать и компилировать, в папке bin есть и java и javac


Artem [10 hours ago]
Ну насчёт часть jdk я бы поспорил, да в в составе jdk есть jre, но он облегченный. У них много общего, соглашусь, но это все таки разные сборки. Вот допустим раньше на компе достаточно было установить jre и запускать программу, без установки java_home. Что для пользователя было удобно. Как я понимаю теперь обязательно устанавливать переменную java_home, чтобы java работала? Или может я че-то не догоняю. И пришёл  jlink это что за фрукт? (edited)


Taras [9 hours ago]
Загляни в готовый war, под WEB-INF увидишь либы, которые туда заносит maven из тех зависимостей, что мы указали (плюс транзитивные). В Java 11 некоторые библиотеки, доступные в прошлых версиях, теперь надо подключать отдельно — и мы их подключили. Так что на целевой машине достаточно иметь jre11 и всё будет нормально. Твой Томкэт все либы из WEB-INF это положит с classpath и приложение их найдёт.


Taras [9 hours ago]
По поводу ручной установки JAVA_HOME. Если у тебя «целевая» машина не девелоперовская, то на ней одна java, и она сама из jre и прекрасно знает, где свои библиотеки. Ты (или не ты), запустив инсталлятор Java, всё это  получил автоматом. А вот если ты для запуска приложения хочешь воспользоваться какими-то нестандартными вещами, сделать доступ из classpath к либам/ресурсам, использовать другую jre, то надо устанавливать.


Artem [8 hours ago]
примерно понял) спасибо за ответ)


Andrey Tolkachev [7 hours ago]
можно еще прописать в идее в разделе Java Compiler версию байткода, для спокойствия, например поставить 8 вместо 11.
Capture.PNG


Стецко Максим [Today at 10:39 AM]
Вроде будет издана книга "Spring 5 для профессионалов" на русском в декабре. Вот что нужно брать сразу)


3 replies
Dima [7 hours ago]
Лучше почитай spring 5 in action на английском. Там уже все на spring boot, и проект хоть интересный. На фронте ангуляр


Стецко Максим [7 hours ago]
когда не знаешь анг, надо читать на русском)


shomnest [6 hours ago]
@Стецко Максим можно ссыль, откуда инфа?


Zhinko [Today at 11:57 AM]
Можно ли в CrudMealRepository получить список еды без аннотации @Query?


17 replies
Taras [6 hours ago]
Эту аннотацию используют, если нет подходящего встроенного метода, или запрос нельзя построить именем метода вида findAllWhereNameLikeOrderById(String name)... постарался не подсказывать, но намекнуть. ;) Поиграйся разными запросами в тесте, разберёшься!


Zhinko [6 hours ago]
Я начал делать так у меня все методы используют @Query. Но что-то мне подсказывает что так не должно быть:)


Gekov Iliya [5 hours ago]
Не должно)


Taras [5 hours ago]
Не надо, можно обойтись тем, что есть. И спринг не будет лишнее парсить, сэкономим энергию, пожалеем природу.. :)


Zhinko [3 hours ago]
Что то я туплю. Как мы можем реализовать метод get без @Query, если у нас 2 id?


Also sent to the channel
Gekov Iliya [3 hours ago]
https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repository-query-keywords Keyword 'ы spring data для написания методов


Taras [3 hours ago]
Найти на youtube видео борисова “spring data та да», очень познавательно.


Gekov Iliya [3 hours ago]
Да оно в ссылках к материалам занятия есть, видео действительно класс


Zhinko [3 hours ago]
Не смотрел. Видимо нужно сначала инфу изучить, а потом пытаться сделать


Gekov Iliya [3 hours ago]
Это 100%)


Dima [3 hours ago]
так человек вроде спрашивал про hibernate. Spring data конечно вещь в себе) бери, да выдумывай методы, а спринг сам все сделает


Gekov Iliya [3 hours ago]
Я так понял вопрос именно по спринг дата и его круд репозиторию


Dima [3 hours ago]
я просто только с работы)) не все патчи еще накатил и не все посмотрел) видимо да, по дате спрашивал.

fonto [2 hours ago]
Описание этих длинных методов есть в документации Спринга)


fonto [2 hours ago]
Но запросами query это более наглядно


Dima [2 hours ago]
https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#jpa.query-methods


Zhinko [1 hour ago]
Вроде разобрался), остался только метод для сохранения, ломаю над ним голову


Dima [5:03 PM]
Первый взгляд после патча о data jpa. А зачем мы в имплементации юзера оверрайдим методы JpaRepository?Они имплементируются автоматически.


Gekov Iliya [Today at 5:04 PM]
В видео объясняется, чтобы обойти ограничения jparepo


7 replies
Dima [1 hour ago]
В CrudUserRepository какие ограничения мы обходим? Если в этом интерфейсе ничего не написать, то в DataJpaUserRepositoryImpl , через  crudRepository будет дергать теже методы.


Gekov Iliya [1 hour ago]
Кода перед глазами нет, сейчас трудно конкретно сказать


Dima [1 hour ago]
в этом интерфесе надо писать методы, которые ты сам придумал, типа List<User> findByEmailOrderByRegistered(String email, Date date) (edited)


Dima [44 minutes ago]
своя обертка DataJpaUserRepositoryImpl - это да, это прикольно. Можно подкрутить Data JPA


Gekov Iliya [37 minutes ago]
Хм, да, я думал ты про это спрашиваешь. Сейчас глянул, действительно, в CrudRepository override по идее не нужен... может для наглядности?


Dima [37 minutes ago]
ну может


Gekov Iliya [35 minutes ago]
А то я помню, когда в первый раз увидел как пустой интерфейс делает все необходимые операции, у меня разрыв шаблона случился)


Zhinko [Today at 5:19 PM]
Подскажите по методу save , а то я в нете норм инфы найти не могу


15 replies
fonto [34 minutes ago]
Что именно подсказать?


Gekov Iliya [33 minutes ago]
Там же есть дефолтный save, какая проблема?


fonto [33 minutes ago]
Он пишется ровно так же как и в jpa, но без то реализации em (edited)


Zhinko [27 minutes ago]
Просто как получить ссылку на юзер?


Zhinko [23 minutes ago]
Или это юзер репозитория брать?


Dima [22 minutes ago]
до дз еще не дошел, но видимо надо в меал засунуть юзера, а потом сделать save. А юзера можно взять по id


Dima [21 minutes ago]
но можно модифицировать стандартный save при помощи @Query и пихнуть там id юзера. Посмотрим)вы все такие быстрые. (edited)


Zhinko [20 minutes ago]
https://stackoverflow.com/questions/45831695/alternatives-to-getreference-method-in-spring-data-jpa
Stack Overflow
Alternatives to getReference method in Spring data JPA
I found myself struggling to implement customizable methods in Spring Data JPA. For example, I have a Pet class, which has an Owner(Many to One rel.) What if I have a method to save(Pet pet, int ow...
 


Zhinko [20 minutes ago]
Мне кажется что так нужно


Gekov Iliya [19 minutes ago]
@Zhinko Да, видимо так, про это и в подсказках сказано


Dima [19 minutes ago]
ну как я тебе и сказал)


Gekov Iliya [19 minutes ago]
6: В Data-Jpa метод для ссылки на entity (аналог em.getReference) : T getOne(ID id)



Gekov Iliya [18 minutes ago]
Смущает только необходимость инжектить два репозитория, но по сути наверное в этом ничего страшного нет...


Zhinko [18 minutes ago]
Да это меня тоже смутило вот я и голову ломал


Gekov Iliya [16 minutes ago]
С другой стороны, лишний раз показывает практическую пользу IoC, если представить сколько бы это проблем прибавило без возможности инжекта


Viktor [5:53 PM]
jdk 11 идет только для x64. Для 32 битной винды уже не работать не будет?
И обязательно ли мигрировать если такой возможности нет?