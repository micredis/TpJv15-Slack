Grigory Kislin [11:21 PM]
joined #graduation.

Grigory Kislin [11:40 PM]
Начиная с 4го занятия можнео приступать к выпускному проекту: https://github.com/JavaWebinar/topjava/blob/doc/doc/graduation.md
Обсуждение здесь. Свои решения НЕ публиковать!
Ревью проекта входит в участие с проверкой домашних заданий (*ревьюится один раз!*).
Отдать на ревью нужно до 09.01.2019 (если идешь на Masterjava, то срок до 31.03.2019).
Успехов! (edited)

Gekov Iliya [11:53 PM]
joined #graduation along with 17 others.


Gekov Iliya [Today at 1:03 AM]
@Grigory Kislin Есть ли возможность оплатить ревью только выпускного проекта?



6 replies
Ilya A. Kvyatkovsky [13 hours ago]
Тоже возник этот вопрос.


Zippospb [6 hours ago]
В прошлом выпуске так точно можно было сделать. Если хотели оплатить лишь ревью проекта, нужно было оплатить из личного кабинета интервью. В этот раз, думаю, будет так же


Grigory Kislin [1 hour ago]
да, есть такое. стоимость как и тестового собеседования - 1950р (edited)


Gekov Iliya [1 hour ago]
@Grigory Kislin Спасибо. А оплачивать через личный кабинет?


Grigory Kislin [1 hour ago]
да, или как тестовое интервью из личного кабинета javaops, либо другим способом: http://javaops.ru/view/payment (при этом отписаться мне) (edited)


Gekov Iliya [1 hour ago]
Понял, спасибо!


Илья Чиликин [1:48 AM]
joined #graduation.

Vitaliy Ivkin [12:19 PM]
Я правильно понимаю, что курсовой проект по сути на всех один и тот же, просто мы делаем его самостоятельно?


Ilya [Today at 12:22 PM]
а как же работа в команде?(


1 reply
Grigory Kislin [1 hour ago]
у работы  в команде, кроме плюсов навыка взаимодействия (что освоить несложно) есть большой минус- кажый делает только свою часть и имеет слабое представление про код остальных. поэтому к работе в команде можно переходить только после того, как освоил все технологии на проекте.


Dima [Today at 7:31 AM]
Так а можно пользоваться благами spring data jpa в связке с spring rest? Или делать все руками?


3 replies
Nikita Ganin [12 hours ago]
Я так понимаю вообще надо всем пользоваться, что изучили, и будем изучать.


Dima [12 hours ago]
Мы пока вручную имплиментировали доступ к базе,хотя со spring data это делается за секунду. И комментах кпроекту написано,что не надо плодить не нужных классов.


Nikita Ganin [9 hours ago]
Ну да, я имел ввиду что нужно использовать последние технологии


Zippospb [1 day ago]
Внимательно читайте пояснения к заданию. Там все написано


Grigory Kislin [17 hours ago]
spring data и spring-rest - будут, см. раписание.
если уже с ним знакомы- можно делать. если нет- лучше подождать занятие


Marat [Yesterday at 8:55 AM]
Начал создавать этот проект в IDEA. Но столкнулся с проблемой - как правильно создать проект? Сделать maven проект, потом добавить в него Web framework ? и потом все зависимости?


13 replies
Marat [1 day ago]
Мы ведь в topjava просто склонировали готовый


Taras [1 day ago]
Создай новый maven проект, добавь сначала зависимости в pom.xml, разреши импорт зависимостей, создай папку webapp там, где у нас, сделай web.xml , подключи в свойствах проекта фреймворки. Проверь на пустом пока проекте, что всё правильно — попробуй сделать package.


Taras [1 day ago]
Да, не забудь переписать их нашего pom кодировку и maven-compiler-plugin.


Marat [1 day ago]
Какого-то автоматического создания нет?


Andrey Tolkachev [1 day ago]
автоматически на Spring-Boot можно
https://start.spring.io/


Marat [1 day ago]
А через архетип maven-archetype-webapp


Marat [1 day ago]
Когда создаешь новый проект maven и потом добавляешь Web Framework, то создается папка Web в корне проекта. А у нас в topjava папка webapp и находится в main. Не пойму в чем разница


Dima [23 hours ago]
Лучше наверно разбираться со спринг бутом,он пользуется большей популярностью сейчас.


Marat [23 hours ago]
Возможно. Но там все упрощенно, все методы для ентити готовы. Думаю может сначала сделать без бута, а потом тоже самое с бутом


Dima [23 hours ago]
Не,ну там основное) методы тебе придется все равно добавлять,хотя тоже просто)


Taras [20 hours ago]
> А у нас в topjava папка webapp и находится в main. Не пойму в чем разница
Есть чётко определённая структура папок, которую требует _maven_: где что лежит, откуда брать ресурсы и куда всё в итоге попадает. Если ты собираешь проект не maven’ом, то и размещаешь где угодно. Для веб-приложений надо, чтоб было `src/main/webapp`, это стандартное размещение. Можно переопределить, но смысла в этом нет..


Taras [20 hours ago]
> А через архетип maven-archetype-webapp
Можно и свой архетип сделать. Но тут проект настолько маленький, что проще стандартно сделать и добавить пару зависимостей, чем разбираться, кто там что написал в стороннем архетипе. (edited)


Grigory Kislin [17 hours ago]
maven-archetype-webapp делает что-то очень древнее.
можно взять то, с чего начали topjava, только без Meal


Marat [7:04 AM]
Как правильно сделать таблицы БД ?
Я планирую так:
Пользователь, Блюдо, Меню, Ресторан и Ланч.
В Ланче сводные уже данные из ресторана и меню. А в меню блюда.


Zhinko [2 days ago]
А как ты будешь определять админ это или нет?


Zhinko [2 days ago]
Я планирую: юзер, роли, еда, ресторан(где будет id админа и Id меню), меню (id ресторана и id еды)


Zhinko [2 days ago]
может у кого-то еще какие-нибудь идеи есть?


Marat [2 days ago]
Как определять админа пока не знаю. А сам как будешь определять?


Marat [2 days ago]
Отдельную таблицу делать что-ли для админа? Но он же юзер на самом деле


Zhinko [2 days ago]
у тебя в топджава есть таблица user_roles, я подозреваю, что если здесь есть юзер и админ, то нужно сделать похожим образом


Nikita Ganin [2 days ago]
А зачем делать отдельно блюдо меню и ланч? У нас же только список с едой


Marat [1 day ago]
Поэтому советуюсь здесь с вами, чтобы понять правильно ли я понимаю или нет, как лучше


Nikita Ganin [Oct 29th at 2:27 PM]
В задании есть условие "меню меняется каждый день", т.е. если в новые сутки админ не вввел никакие данные, то собственно и голосовать не за что? Как кто понимает это?


15 replies
Taras [1 day ago]
Я понимаю так, что все данные о меню и голосовании «обнуляются» каждый день, то есть по мере наполнения базы информацией о меню в ресторанах появляется возможность за эти рестораны голосовать. Вчера было меню, а сегодня может и не быть.


Sergey Zhukov [1 day ago]
не обнуляется, голосовать за блюдо в ресторане можно не чаще раза в сутки


Taras [1 day ago]
Речь об этом: каждый день начинается с чистого листа. Ты голосуешь за один день, а в следующем новые данные по ресторанам и меню.


Ilya A. Kvyatkovsky [1 day ago]
Сегодня *29.10.2018*: *Юзер* заходит в апп -> Видит _список ресторанов у которых *есть ланч-меню на сегодня*_ -> Открывает меню ресторана ххх -> Видит *список еды* этого *ресторана* на *сегодня* -> Голосует или нет. (Если у ресторана нет ланч-меню на сегодня, то юзер не увидит этот ресторан в списке и не сможет проголосовать) По рекомендациям, представил весь процесс с точки зрения Админа и Юзера, все возможные действия расписал схематично. Проект получается аналогичный тому, что мы делаем с Григорием. У меня получается 5 таблиц (USERS, ROLES, RESTAURANTS, MENU, VOTES). Не нашел вариант как запаковать поплотнее. (edited)


Marat [1 day ago]
А в таблице MENU как блюда делить? Не нужно разве отдельную таблицу с блюдами?


Marat [1 day ago]
В MENU будет id ресторана к каждому блюду?


Marat [1 day ago]
Я думал что меню статично и Админ его редактирует. Пока не поменяет - ничего не измениться
Menu changes each day (admins do the updates) (edited)


Ilya A. Kvyatkovsky [1 day ago]
В таблице MENU вся еда всех ресторанов. date_time/restaurant_id/dish_name/dish_price
Вот только не могу понять нужно ли поле ID для этой таблицы.
Рекомендация № 13 - нужно хранить историю еды. (edited)


Marat [1 day ago]
А в VOTES будешь хранить id юзера, ресторана и меню?

Ilya A. Kvyatkovsky [1 day ago]
дата_время голосования/user_id/restaurant_id
голос как я понимаю отдается ресторану за его меню (edited)


Marat [1 day ago]
Ну как я понял это не голосование, а бронирование своего обеда на сегодня. Или не так?


Ilya A. Kvyatkovsky [1 day ago]
Да, очень похоже, с небольшими оговорками по структуре и функционалу.

Ilya A. Kvyatkovsky [1 day ago]
Это субъективно мои предположения и я бы не рекомендовал следовать им, т.к. мой опыт СУБД ограничен исключительно школьной программой 10-ти летней давности.


pro [21 hours ago]
@Ilya A. Kvyatkovsky десять лет назад в школе преподавали управление базами?.. Где эта школа, я хочу на нее посмотреть, (сквозь слезы) хотя бы через гугл мап


Ilya A. Kvyatkovsky [20 hours ago]
@pro не понимаю что тут удивительного, школы все разные и преподаватели в них тоже разные, а на дополнительных занятиях рассказывают немного больше чем обычно.


Zhinko [Yesterday at 4:21 PM]
Давайте подумаем как лучше сделать БД. Вот что у меня получилось. Жду предложений.
PUBLIC.png



24 replies
Marat [22 hours ago]
Почему ID ресторана находится в еде?



[22 hours ago]
я в таблицу ресторана добавил поле "дата обновления", чтоб потом использовать его в выдаче списка ресторанов с обновленным меню именно нужного дня. Остальное сделал через таблицы меню и еда. К security и голосам пока не подходил, играюсь пока с выводом нормального jsona


[22 hours ago]
@Marat видимо потому, что потом будет использовать ManyToOne аннотацию


Marat [22 hours ago]
Не наоборот должно быть? В ресторане еда


Zhinko [22 hours ago]
Тогда у тебя будут строки в ресторане повторяться так как ресторан один а еды много


Chensy [22 hours ago]
У меня почти также, только вот зачем в USERS поле VOTED ?


Zhinko [22 hours ago]
Типо поле проголосовал юзер или нет


Chensy [22 hours ago]
Зачем? ты это поле что постоянно менять будешь? эта инфа же есть в таблице VOTES


Zhinko [22 hours ago]
А как тогда сделать так , чтобы юзер мог голосовать только один раз , а не сколько хочешь раз?


Chensy [21 hours ago]
Ограничение DATE+USER_ID в таблице VOTES как вариант



Zhinko [21 hours ago]
В принципе да, ты права, я об этом не подумал)


[19 hours ago]
Когда пытаешься достать ресторан посредством JPA, ругается на то, что отсутствует передаточная таблица ресторан_меню. Как можно вытащить меню из ресторана без этой таблицы?


[18 hours ago]
Почему в JPA есть дофига Query методов для таблицы, но ниодной для обьединения таблиц (JOIN)


Sergey [18 hours ago]
схема на рис. верная, проверяй как ты достаешь ресторан )


Sergey [18 hours ago]
Есть join, вот пример:  https://stackoverflow.com/questions/5478328/jpa-jointable-annotation
Stack Overflow
JPA "@JoinTable" annotation
In which case do you use JPA @JoinTable annotation?
 


[18 hours ago]
та это понятно, я имел в виду что то типа метода findAllRestaurantJoinMenu()


[18 hours ago]
но да, получается я туплю. Когда я достаю ресторан методом findById(Long id) , то с рестораном подтягивается еда. А если findAll(), то нет. какая то мистика, где то закралась ошибка


Sergey [18 hours ago]
Вытаскивать все из 2х таблиц и еще и join-ить очень накладно. Вот hibernate тебя и не слушает ))

[18 hours ago]
ща удалил связующую таблицу ресторан_меню и он отказывается доставать.

[18 hours ago]
111111.jpg



[18 hours ago]
с таблицей связи все ок, даже без всяких @JoinTable


[18 hours ago]
а если хранить отдельно ресторан, отдельно еду, и отдельно сушность еда ресторана?


[18 hours ago]
также отдельно юзером и таблицу за какой ресторан проголосовали юзеры

Marat [4 hours ago]
А у юзера не должно быть email ? Как он будет регистрироваться?


Grigory Kislin [Oct 31st at 9:49 PM]
опрос- не кто не против выкладывания тут готовых решений? не мешает разрабатывать самостоятельно?
 


13 replies
Dima [1 day ago]
ну если не обсуждать свои решения, то смысл вообще в канале) не против


Gekov Iliya [1 day ago]
Мне кажется это лишним, как то чистота эксперимента по проверке своих способностей теряется. Можно обсудить после 09.01 кто как сделал. С другой стороны можно просто отписаться от канала, если нет желания смотреть чужие решения


[1 day ago]
с толку сбивают чужие мысли ) я стараюсь не вникать, буду использовать как "прогресс-бар", чтобы не отставать  :relaxed:
надо было правила что ли придумать заранее, - типа "только вопросы к администрации по пунктам задания, реализация - только в личку"


Gekov Iliya [1 day ago]
Согласен


[1 day ago]
чо пальцы ставим кто  против решений - :-1:


Dima [1 day ago]
:call_me_hand:


Dima [1 day ago]
это типо пофиг)
 


Ilya A. Kvyatkovsky [1 day ago]
Выкладывать готовые решения, безусловно бесполезно для всех кто хочет действительно научиться самостоятельно разрабатывать подобные проекты, а вот если ты в тупике или не знаешь какое решение принять, то думаю, что если ребята накидают своих мыслей, то это реально поможет сдвинуться с мертвой точки. (по себе знаю)). Ну а дальше каждый сам решает какая степень знаний ему нужно, все делать с чужой помощью или полностью самостоятельно. Я бы не прочь получить еще штучек 5 подобных ТЗ, что бы отточить навыки.)  (хотя у самого проект пока процентах на 5-10 :stuck_out_tongue_winking_eye:)


Marat [1 day ago]
Смысл запрещать нет, так как на работе все равно консультируешься с колегами как все-таки правильно сделать. Тот же Слак, только живой


Nikita Ganin [1 day ago]
Одно дело когда ты сам задаешь вопрос, а другое когда просматривает чужие решения. Может просто не стоит выкладывать свое решение, чтобы его оценили. (edited)



YuriyUh [1 day ago]
Максимум вопрос и ответ где почитать, все остальное действительно сбивает с толку.



Andrey Tolkachev [1 day ago]
я согласен с @Ilya A. Kvyatkovsky, не вижу никаких проблем в выкладывании своего решения. Здесь ведь никого из под палки не заставляют учиться и делать проект) Если человек хочет сделать сам, то он и не будет смотреть, или просто отпишется на время. Ну а если есть затык в каком-то месте, то общая группа в этом плане может сильно помочь. Имхо, каждый сам решает, работает он над собой, или просто занимается копипастом :slightly_smiling_face:


Andrew Kalugin [1 day ago]
Я не против. Если ты хочешь сделать все сам, то просто не читай. Если решил все скопировать, то смысл вообще тут учиться? @Andrey Tolkachev согласен, иногда нужен совет, что бы сдвинутся с мертвой точки, а группа может помочь.


Yesterday at 7:44 AM]
имеет ли значение какую СУБД выбирать для проектов в портфолио, чтобы удобно было смотреть работу приложения? наверное, лучше локальную вроде hsqldb? вы делали на hsqldb или на postgers?


1 reply
Gekov Iliya [1 day ago]
В подсказках про это сказано


Grigory Kislin [10:09 AM]
@here
*Коллеги- по опросу - свои решения  НЕ выкладываем. Когда мне задают вопрос- я стараюсь дать полезные ссылки или совет, но чтобы человек дошел до ответа самостоятельно. Учимся думать. Отписаться от канала - не вариант, тк здесь все таки оказываем такого рода поддержку. Можно сделать собственный канал или чат (права есть) и делится решениями там, для тех, кто не против.* (edited)


Marat [Yesterday at 5:44 PM]
Все таки лучше делать глобальный сиквенс или для каждого энтити свой?


2 replies
Marat [23 hours ago]
Вроде бы когда пишут на процедурах в базе данных, то делают для каждого свой сиквенс.
А когда пишут в Java приложении, то как обычно делают? Один глобальный или нет?


Grigory Kislin [5 hours ago]
скорее тут нет как обычно. и как лучше. вроде в занятии была ссылка на + и - (edited)


Raisa [Today at 7:55 AM]
а если в restaurants сделать строку с блюдами и перечислять их через ;, к примеру. Когда они будут нужны просто выделять нужные подстроки. Т.е. не делать отдельную таблицу с едой. Нам ведь нужны только название и цена.


18 replies
Dima [10 hours ago]
Почитай про так называемые нормальные формы таблиц. Перечислять как ты говоришь bad practice, очень бэээд)) доставать из таблицы инфу очень муторно. И если хратить информацию по голосованиям,то возможно придется хранить инфу по еде.А ее тысячи (edited)



Gekov Iliya [9 hours ago]
А еще по тз нужно хранить историю всех ланчей


Raisa [9 hours ago]
я читала и насколько поняла, суть нормализации как раз в том, чтобы предотвратить избыточность данных )  разве 2-5 блюд в день сильно муторно выводить? голосование же не за еду, а за ресторан? еда ведь нужна только для того, чтобы понять интересен ресторан или нет?


Gekov Iliya [9 hours ago]
IMG_20181106_090323.jpg



Dima [9 hours ago]
Ну вот ошиблась ты в цене на еду,она у тебя записывается в строчку,одна за одной,чтоб поменять тебе надо достать всю еду ресторана,потом в ней найти нужную еду,короче это гемор


Gekov Iliya [9 hours ago]
Как хранить в таком случае историю еды? В виде бесконечного стринга? А как разделять название еды и его стоимость? Если это делать через строчку, то тот кто будет писать фронт не сможет сформатировать вывод, он будет вынужден нарисовать фронт так как заложено у вас, а не так как хочет к примеру заказчик (edited)


Sergey Zhukov [9 hours ago]
Закладывай сразу возможность вытаскивать отдельно еду каждого ресторана с помощью запроса к базе. Если это парсинг ячейки - уже должно насторожить


Raisa [9 hours ago]
@Dima если админу нужна возможность доставать по частям - цену, название и т.д, то да, нужна отдельная таблица


Gekov Iliya [9 hours ago]
Это не говоря уже о том, чтобы предусмотреть возможность расширения, к примеру добавления фото еды, состава и т.п.


Raisa [9 hours ago]
@Gekov Iliya говорили не додумывать ) не всегда пока понятно, что является додумыванием, а что нет :woman-shrugging:


Raisa [9 hours ago]
насчет хранения истории еды я не совсем поняла, что имеется ввиду - хранить именно блюда из ресторана или рестораны, где обедали? я склоняюсь к тому, что рестораны. возможно, ошибаюсь


Dima [9 hours ago]
Конечно надо ему доставать) онбудет у себя в javascript писать расположение цены,еды как обьекты. Точно так же как мы в jsp писали



Gekov Iliya [9 hours ago]
На вырезке что я скинул как раз об этом и говорится, что есть базовые вещи а есть неочевидные додумки, рассмотреть разные возможности обращения к данным и расширяемость этих данных - это базовая архитектура


Raisa [9 hours ago]
ок, спасибо! что-то проясняется (edited)


Gekov Iliya [9 hours ago]
Но это в любом случае только наше имхо)


Raisa [6 hours ago]
я поняла: история еды - это дата + выбранный ресторан + еда в данном ресторане в этот день. Так? Список ресторанов статичен, если админ его не меняет, а еда во всех ресторанах каждый день обновляется


Gekov Iliya [6 hours ago]
Да, мне кажется именно так


Grigory Kislin [5 hours ago]
реляционные базы данных- достаточно стандартизированная вещь. И там хранить списками- бывает, но совсем не часто и для особых случаев. В данном случае еда- это конечно же отдельная таблица. Она будет обрастать со временем картинками, описанием и пр..


Zhinko [Yesterday at 1:04 PM]
Вопрос. Нужна ли нам таблица в БД menu? По сути мне кажется, что не нужна если еду можно доставать сразу из таблицы еды.


5 replies
Gekov Iliya [1 day ago]
Я думаю также, если понадобится в дальнейшем можно это сделать в виде ТО


Dmitry Neustupov [18 hours ago]
т.е. у каждой записи в таблице еда будут поля, какому ресторану она принадлежит и дата, к которой эта еда привязана? соответственно у вас будет десять разных яблок к разным ресторанам на разные даты? или есть другие способы реализовать историю меню у ресторанов? ) не проще сделать меню с этими полями и наполнять едой?


Gekov Iliya [18 hours ago]
А что подразумевается под наполнять едой? В каком виде будет еда? Без отдельной таблицы, просто списком текста? В таком случае нет, не думаю, что это проще, такой вариант уже обсуждался выше в ветках


Dmitry Neustupov [18 hours ago]
Есть рестораны(таблица) - у ресторанов есть меню(таблица) - у меню есть еда(таблица).  Ведь в разных ресторанах в разные даты может быть одна и та же еда? Не читал выше каменты, сори, не знаю о чем речь была )


Grigory Kislin [16 hours ago]
можно дату располагать в таблице еды, тогда меню не нужна. а еще лучше сделать еду как справочник...


Dima [Yesterday at 5:41 PM]
а можно пример как пишется readme фаил ? тупо url -> что делает запрос?


1 reply
Grigory Kislin [16 hours ago]
https://github.com/JavaWebinar/topjava/blob/master/README.md (edited)


Dima [Today at 2:03 PM]
появился вопрос по поводу загрузки дополнительных данных при обращении к базе: есть ресторан, у него допустим есть колекция еды, с Fetch.Lazy. Делаю простое ображение к базе select r from Restaurant r where r.id=?1 и вижу, что кроме листа ресторанов подтягиваются листы еды этих ресторанов. Такое вроде бы не должно быть?


3 replies
Gekov Iliya [5 minutes ago]
Прям в обе таблицы запрос идет?


Dima [2 minutes ago]
да, два select, как будто Eager стоит


Gekov Iliya [1 minute ago]
Вроде не должно, сейчас гляну как у меня такой запрос проходит


Marat [Today at 2:05 PM]
Если у меня Votes имеет внешние ключи к Restaurants и Users, то В репозитории сохранения голоса нужно указывать все 3 параметра? Vote, restaurant_id, user_id


1 reply
Dima [< 1 minute ago]
в репозитории можно ничего не указывать, предварительно записав в обьект нужные данные:
```Vote vote = new Vote(); vote.setRestaurantId(restId); vote.setUserId(userId); voteRepo.save(vote);```


Maxim [Yesterday at 10:55 PM]
Кто как планирует\сделал работать с бд: Spring data, Hibernate, JPA?


1 reply
Dima [12 hours ago]
у меня все через spring data, но чувствую все придется через @Query делать, потому что много запросов к базе.


Grigory Kislin [3 days ago]
рекомендую spring-data-jpa


Maxim [3 days ago]
spring data все таки легче чем чисто JPA, может "хлебнуть горя" и получить больше опыта с entitymanagerfactory? или это впоследствии не нужно?


Grigory Kislin [1 day ago]
в тестовом на работу я рекомендую юзать spring-data-jpa


pal548 [Nov 9th at 11:48 PM]
Все ли знают про диаграмму сущность-связь? Помогает при проектировании БД


6 replies
Alexey_b [2 days ago]
не, не встречался раньше, положу в закладки


Sergey Zhukov [1 day ago]
@pal548 есть ссылка с хорошим материалом?


pal548 [1 day ago]
неа, я с института помню. Я щас посмотрел, все предлагают непростые диаграммы, а я делаю просто сущности и связи линиями


pal548 [1 day ago]
Вот пример, тут все линии один-ко-многим. Многие-ко-многим будет соответственно линия с "вилкой" на обоих концах
IMG_20181111_002322.jpg



Gekov Iliya [1 day ago]
Эту диаграмму же идея строит, не?


pal548 [20 hours ago]
Ну смысл в том, чтобы начать проектирование БД не с создания таблиц, а с этой диаграммы. Идея строит диаграмму по сущностям?


Ilya A. Kvyatkovsky [Nov 10th at 1:57 PM]
jar или war? По ТЗ не могу однозначно определить. Думаю что jar но не уверен. Может кто объяснить как по нашему условию можно определить тип приложения? (edited)


5 replies
Zhinko [2 days ago]
Тут же вроде написано
P.P.S.: Asume that your API will be used by a frontend developer to build frontend on top of that.


Zhinko [2 days ago]
Судя по описанию мы делаем веб приложение


Стецко Максим [1 day ago]
как я понял бы делаем бекэнд, а что будет фронтом это уже на усмотрение (API же можно пользоваться и вебом и настольным приложением). Я вообще буду фронт на JavaFx пилить, он только на 11 java отъехал в отдельную библиотеку, но хочу на нем делать и все)


Grigory Kislin [1 day ago]
@Ilya A. Kvyatkovsky а как ты хочешь jar  делать?


Sergey Zhukov [1 day ago]
@Ilya A. Kvyatkovsky
Есть способ сделать *jar* - использовать SpringBoot.
Если Hibernate/Spring/SpringMVC - делаем *war*.


Lamekhova Alisa [Today at 9:11 AM]
Получилась вот такая схема. Чего не хватает?


8 replies
Lamekhova Alisa [7 hours ago]
unnamed.jpg



Lamekhova Alisa [7 hours ago]
Нужно ли поле что-то типо рейтинг ресторана?


Zhinko [5 hours ago]
Даты в еде. Тебе же нужно историю еды хранить


Zhinko [5 hours ago]
Что значит поле in-menu в meals?


Lamekhova Alisa [4 hours ago]
in menu - админ будет выставлять тру, если блюдо входит сегодня в меню, по умолчанию будет фолс


Lamekhova Alisa [4 hours ago]
Точно, даты в еде, 4 раза перерисовала схемку и забыла даты в еду перенести)


Zhinko [3 hours ago]
@Lamekhova Alisa смысл в in menu?. Ты будешь доставать значения из базы чтобы только тру на фолс поменять?


Zhinko [2 hours ago]
Как я понял согласно условию меню меняется каждый день. Ты можешь достать еду из базы совпадающую с сегодняшней датой. Эта еда и будет входить в сегодняшнее меню


Lamekhova Alisa [21 hours ago]
Блин да, это лишнее(


Lamekhova Alisa [Today at 9:51 AM]
В MealRepo есть метод Meal get(int id, int userId); // null if meal do not belong to userId. В своем проекте делаю аналогичный, но в нем ведь не надо проверять принадлежит ли еда к ресторану? Т. е. он просто может гетать еду по id, как в UserRepo


1 reply
Grigory Kislin [1 hour ago]
если еда привязана к ресторану то надо проверять


Lamekhova Alisa [Today at 10:37 AM]
И еще вопрос: в методах типо                                                                      //Get all votes for the restaurant, null if restaurant not found
List<Vote> getAllRestaurantVotes(int restaurantId); лучше возвращать null если ресторан не найден или кидать что-то вроде NotFoundException?


3 replies
Dima [4 hours ago]
Я втаких методах возвращал Optional<Vote> и всамом сервисе получаю List<Vote> voteRepo.getAll(rest).orElseThrow new Exception


Dima [4 hours ago]
И сделал ExceptionHandler,который перехватчвает все мои исключения и отправляет ответ от спрвера красивый


Grigory Kislin [1 hour ago]
1. return List - никогда не возвращай null, всегда пустой список
2. если restaurantId передан с ошибкой- то это ошибка входящих данный, требуется эксепшен


Lamekhova Alisa [3 days ago]
Спасибо за ответы, все встало на места)


lifter4ik [Nov 13th at 6:52 PM]
Что вообще подразумевается под историей? Ведение лога не будет достаточным, что такой-то юзер проголосовал за такой-то ресторан в такое-то время?


18 replies
Gekov Iliya [3 days ago]
Нет, лог нужен разработчику, а не пользователю приложения. Думаю, подразумевается, что, возможно, в дальнейшем появится необходимость предоставить админу возможность просматривать историю, либо предоставить юзеру возможность посмотреть за что и когда он голосовал и т.п. Если это не заложить сразу в основу архитектуры, то придется перелопачивать все приложение для добавления функционала (edited)


lifter4ik [3 days ago]
Тогда получается для этого отдельная таблица нужна по типу Дата, Пользователь, Событие? Не пойму как эту историю увязать в общую картину...


Gekov Iliya [3 days ago]
Не обязательно, достаточно, к примеру, сохранять в таблице еды дату и ресторан - этого будет достаточно для истории еды. И, к примеру, ввести таблицу для голосования, которая будет выполнять две функции - собственно сохранять историю голосования (не забываем про то, что по ТЗ юзер может изменить свой голос, соответственно нам априори надо сохранять в базе его голос) и служить средством подсчета итогов голосования.


Gekov Iliya [3 days ago]
Но варианты могут быть разные, это лишь мое имхо)


lifter4ik [3 days ago]
Подумаю, спасибо! А по поводу блюд в ресторане, мне кажется, что меню-то может миксоваться, в том плане правильно ли закреплять конкретную еду за конкретным рестораном на текущий день? Я смотрю больше в сторону отношения многие ко многим. Кофе например во всех будут подавать))


Gekov Iliya [3 days ago]
Лично мне кажется это слишком сложным. Кофе в одном ресторане это все же не кофе в другом ресторане, тем более если уж так рассуждать, то кофе тоже может быть десятков разных видов. Опять же, если думать о расширяемости в дальнейшем, то предположим, что мы добавляем к еде изображения, состав и т.п. Тогда одно и то же по названию блюдо все равно будет отличаться в двух разных ресторанах. (edited)


Gekov Iliya [3 days ago]
С другой стороны можно сделать еду в виде какого-то каталога, из которого админ может выбирать, либо если блюдо новое и отличается - добавлять новое в список. В общем вариантов на самом деле масса


lifter4ik [3 days ago]
Да, многие ко многим лишнее. Просто каталог побогаче сделать))


lifter4ik [3 days ago]
С ролями тоже думаю, тут по тредам все в отдельную таблицы их отправляют как у нас на обучающем проекте. Но там юзер может быть и админом и пользователем обычным одновременно. А тут в тз же четко, есть админы, есть обычные. Так не лучше роль сразу хранить в таблице users?


Gekov Iliya [3 days ago]
Возможно, как то не задумывался об этом


lifter4ik [3 days ago]
А самое для меня пока непонятное, как нам работать со временем... До 11, после 11, новый день... В реале легко представить: админы встали в 7 утра, меню накидали, пользователи тыкают голоса. Потом дружно идут в один ресторан (коммуна прям какая-то). А как тестировать приложение не понятно. Часики системные подправлять?)) Или в каждом методе время устанавливать


Lamekhova Alisa [3 days ago]
Блин и правда, не нужна тут получается таблица с ролями?


lifter4ik [3 days ago]
Ну вот попробовав учесть историю и отсекая все лишнее, такую картину нарисовал
IMG_20181113_215920.jpg



Lamekhova Alisa [3 days ago]
А есть смысл меню в отдельной таблице делать?


lifter4ik [2 days ago]
На этой структуре я еду представляю как справочник, что бы там не было повторов. А меню будет хранить историю


Pushkin [1 day ago]
Друзья! Григорий вроде говорил сделать историю голосования, а не блюд в меню. Я тоже сделал как на картинке у Лифтерчика, только menu и dishes у меня в одной таблице dishes. Dish имеeт дату создания, restaurantId, price. А история голосования тогда просто из votes выбирается.


Gekov Iliya [1 day ago]
@Pushkin вопрос не в истории меню, а в том, что при таком варианте каждая еда уникальная. Но если представить реальную ситуацию, то сомнительно, что в одном и том же ресторане блюдо в меню не будет повторяться, скажем через неделю. Для того, чтобы можно было выбрать еду из уже существующего списка еды и создается разделение на сам список еды и меню на конкретный день. То есть еда представлена как справочник - об этом Григорий так же говорил в одном из тредов.


Gekov Iliya [1 day ago]
@Pushkin кстати, смотрим пункт 13 подсказок: Историю еды и голосований сделать НУЖНО!... Так что речь шла не только об истории голосований (edited)


Lamekhova Alisa [Nov 14th at 10:57 AM]
Есть смысл делать интерфейсы репозиториев и сервисов в выпускном проекте или можно сразу классы делать? Я понимаю зачем это надо в первом проекте, но зачем тут они нужны непонятно. Или это правила хорошего тона? Или задел на будущее?


4 replies
Dima [2 days ago]
Тогда может получится слишком "толстый контроллер". Это и бизнес логику в нем писать придется,и обработку валидации и тд. Слой сервиса я делал и в нем уже все настраивал,вытаскивал из базы


Lamekhova Alisa [2 days ago]
Я имею в виду интерфейс сервис и имплементация сервиса, то же самое с репозиторием. Мб сразу класс сервис делать без интерфейса? В проекте разные имплементации репозитория, поэтому нужен интерфейс, но в выпускном проекте наверно не нужно это? Или так просто принято ?


Dima [2 days ago]
Для тестового задания,как написал Григорий,надо делать только точто используешь



shomnest [2 days ago]
@Lamekhova Alisa ооп и паттерны ооп, это всегда много дополнительного кода, который в совокупности привносит гибкость и расширяемость.


Ilya A. Kvyatkovsky [11:55 PM]
Глупый Battle
Если делать интерфейс наследующий JpaRepository<T, ID> и назвать его например "MealRepository", то при попытке воспользоваться имплементацией метода save(S entity) вылетает java.lang.StackOverflowError.
Об этом вероятно в лекциях где-то говорилось, но решение оказалось простым и не очевидным, если не знать что, интерфейсы наследующие JpaRepository<T, ID> должны именоваться начиная со слова "Crud" те в моем случае "CrudMealRepository", после чего метод save() чудесным образом все отрабатывает. Есть где об этом информация? (edited)

Grigory Kislin [3:09 PM]
> при попытке воспользоваться имплементацией метода save(S entity) вылетает java.lang.StackOverflowError.
если деграть самого себя - то будет StackOverflowError. почитать скорее про рекурсию